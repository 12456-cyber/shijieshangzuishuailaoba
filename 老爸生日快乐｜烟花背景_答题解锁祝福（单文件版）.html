<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>è€çˆ¸ç”Ÿæ—¥å¿«ä¹ï¼ğŸ‰</title>
  <style>
    :root{
      --card-bg: rgba(255,255,255,.12);
      --card-blur: blur(10px);
      --brand: #ffd166;
      --ok: #06d6a0;
      --warn: #ef476f;
      --text: #f8fafc;
      --muted: #cbd5e1;
      --shadow: 0 10px 30px rgba(0,0,0,.25);
    }
    *{box-sizing: border-box}
    html,body{height:100%;margin:0;background:#0b1020;color:var(--text);font-family:-apple-system, BlinkMacSystemFont, "PingFang SC", "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Noto Sans CJK SC", "Helvetica Neue", Arial, "Hiragino Sans GB", "Microsoft YaHei", sans-serif}
    #stage{position:fixed;inset:0;background:radial-gradient(1200px 600px at 50% 120%, #09122b 10%, #0b1020 60%, #030712 100%);} 
    canvas{display:block;width:100%;height:100%}

    .wrap{position:relative;z-index:2;min-height:100%;display:grid;place-items:center;padding:24px}

    .card{width:min(680px,92vw);background:var(--card-bg);backdrop-filter:var(--card-blur);border:1px solid rgba(255,255,255,.08);border-radius:24px;box-shadow:var(--shadow);padding:28px 24px}
    .title{display:flex;align-items:center;gap:12px;font-weight:800;letter-spacing:.5px}
    .badge{padding:4px 10px;border-radius:999px;background:linear-gradient(135deg,#7c3aed,#06b6d4);font-size:12px}
    .progress{height:8px;background:rgba(255,255,255,.12);border-radius:999px;overflow:hidden;margin:16px 0 4px}
    .bar{height:100%;width:0;background:linear-gradient(90deg, #60a5fa, #a78bfa, #f472b6);transition:width .35s ease}

    .q{font-size:22px;line-height:1.4;margin:12px 0 18px}
    .options{display:grid;grid-template-columns:1fr;gap:12px}
    .btn{position:relative;border:none;border-radius:14px;padding:14px 16px;background:rgba(255,255,255,.08);color:var(--text);font-size:16px;cursor:pointer;transition:transform .08s ease, background .2s ease, box-shadow .2s ease}
    .btn:hover{transform:translateY(-1px);background:rgba(255,255,255,.12)}
    .btn:active{transform:translateY(0)}
    .btn.ok{background:rgba(6,214,160,.18);box-shadow:0 0 0 2px rgba(6,214,160,.35) inset}
    .btn.no{background:rgba(239,71,111,.18);box-shadow:0 0 0 2px rgba(239,71,111,.35) inset}

    .hint{min-height:22px;color:var(--muted);margin-top:8px}

    .footer{display:flex;justify-content:space-between;align-items:center;margin-top:16px;color:var(--muted);font-size:13px}

    .done{display:none;flex-direction:column;align-items:center;text-align:center;gap:14px}
    .done.show{display:flex}
    .done h1{font-size:34px;margin:0}
    .msgs{display:flex;flex-direction:column;gap:10px;width:100%}
    .msg{opacity:0;transform:translateY(8px);transition:opacity .5s ease, transform .5s ease;padding:14px 16px;border-radius:14px;background:rgba(255,255,255,.08);box-shadow:var(--shadow);border:1px solid rgba(255,255,255,.06);text-align:left}
    .msg.show{opacity:1;transform:none}
    .again{margin-top:6px}

    .shake{animation:shake .35s linear}
    @keyframes shake{10%{transform:translateX(-4px)} 20%{transform:translateX(4px)} 30%{transform:translateX(-4px)} 40%{transform:translateX(4px)} 50%{transform:translateX(-2px)} 60%{transform:translateX(2px)} 70%{transform:translateX(-2px)} 80%{transform:translateX(2px)} 90%{transform:translateX(0)} }

    .credit{position:fixed;right:10px;bottom:8px;z-index:3;font-size:12px;color:#94a3b8;opacity:.8}
    .credit a{color:#c7d2fe;text-decoration:none}

    .musicBtn{position:fixed;left:10px;top:10px;z-index:4;border:none;border-radius:999px;padding:10px 14px;background:rgba(255,255,255,.14);color:#f8fafc;backdrop-filter:blur(10px);box-shadow:0 8px 20px rgba(0,0,0,.25);cursor:pointer}
    .musicBtn:hover{background:rgba(255,255,255,.2)}

    /* ğŸ‚ è›‹ç³•ä¸èœ¡çƒ›æ ·å¼ */
    .cakeStage{display:none;flex-direction:column;align-items:center;text-align:center;gap:16px}
    .cakeStage.show{display:flex}
    .cake{position:relative;width:180px;height:110px;background:linear-gradient(180deg,#ffe8a3,#ffc96b);border-radius:16px 16px 12px 12px;box-shadow:0 10px 20px rgba(0,0,0,.25) inset, 0 6px 18px rgba(0,0,0,.25);margin-bottom:24px}
    .cake::before{content:"";position:absolute;left:0;right:0;top:-18px;height:26px;border-radius:16px 16px 0 0;background:repeating-linear-gradient(135deg,#ff8fab 0 12px,#ffd6a5 12px 24px)}
    .candles{position:absolute;left:50%;top:-22px;transform:translateX(-50%);display:flex;gap:22px}
    .candle{width:8px;height:28px;border-radius:4px;background:#fff}
    .flame{position:absolute;left:50%;top:-12px;transform:translateX(-50%);width:10px;height:14px;background:radial-gradient(circle at 50% 60%, #fff 0 35%, #ffd166 36% 60%, rgba(255,209,102,.2) 61%);border-radius:50%;filter:blur(.2px);animation:flicker .12s infinite alternate}
    @keyframes flicker{from{transform:translateX(-50%) scale(1)} to{transform:translateX(-50%) scale(1.08)}}
    .cake.out .flame{display:none}
    .blowText{color:#e2e8f0;font-size:16px;margin-top:8px}
  </style>
</head>
<body>
  <div id="stage"><canvas id="fx"></canvas></div>

  <div class="wrap">
    <div class="card" id="quizCard">
      <div class="title">
        <span class="badge">å°æŒ‘æˆ˜</span>
        <span>ç­”å¯¹å°±èƒ½é¢†å–ä¸“å±ç¥ç¦ï½</span>
      </div>
      <div class="progress" aria-hidden="true"><div class="bar" id="bar"></div></div>

      <!-- âœ… æµ‹éªŒç»“æ„ï¼Œç¡®ä¿å­˜åœ¨ qText / opts / hint / stepTxt å…ƒç´  -->
      <div id="quiz">
        <div class="q" id="qText">åŠ è½½ä¸­...</div>
        <div class="options" id="opts"></div>
        <div class="hint" id="hint" aria-live="polite"></div>
        <div class="footer">
          <span id="stepTxt">ç¬¬ 1/1 é¢˜</span>
          <small>ç¥ï¼šè€çˆ¸ç”Ÿæ—¥å¿«ä¹ ğŸ‚</small>
        </div>
      </div>

      <!-- ğŸ‚ è›‹ç³•èˆå°ï¼ˆé€šå…³åæ˜¾ç¤ºï¼‰ -->
      <div class="cakeStage" id="cakeStage" aria-live="polite">
        <h2 style="margin:0">ğŸ‚ ç¥è€çˆ¸ç”Ÿæ—¥å¿«ä¹ï¼</h2>
        <div class="cake" id="cake">
          <div class="candles">
            <div class="candle"><span class="flame"></span></div>
            <div class="candle"><span class="flame"></span></div>
            <div class="candle"><span class="flame"></span></div>
          </div>
        </div>
        <div class="blowText" id="blowText">å¹ä¸€ä¸‹</div>
      </div>

      <!-- ğŸ‰ ç¥ç¦èˆå° -->
      <div class="done" id="done">
        <h1>ğŸ‰ æ­å–œé€šå…³ï¼</h1>
        <p style="margin:0;color:#cbd5e1">ä¸“å±ç¥ç¦å·²è§£é”ğŸ‘‡</p>
        <div class="msgs" id="msgs"></div>
        <button class="btn again" id="again">å†çœ‹ä¸€éçƒŸèŠ± & ç¥ç¦</button>
      </div>
    </div>
  </div>

  <div class="credit">ğŸ’¡ æç¤ºï¼šç‚¹å‡»æˆ–è½»è§¦å±å¹•ä¹Ÿä¼šæ”¾çƒŸèŠ±ï½</div>
  <button id="musicBtn" class="musicBtn" aria-pressed="false" title="æ’­æ”¾/æš‚åœèƒŒæ™¯éŸ³ä¹">ğŸµ èƒŒæ™¯éŸ³ä¹</button>

  <script>
    // ====== é¢˜åº“ï¼ˆå¯æŒ‰éœ€ä¿®æ”¹ï¼‰ ======
    const QUESTIONS = [
      {
        q: "ä»Šå¤©è°æœ€å¸…ï¼Ÿ",
        options: ["è€çˆ¸", "è€å¦ˆ", "å°éƒ­"],
        answerIndex: 0,
      },
      {
        q: "ä»Šå¤©è°è¿‡ç”Ÿæ—¥ï¼Ÿ",
        options: ["è€çˆ¸", "è€å¦ˆ", "å°éƒ­"],
        answerIndex: 0,
      },
      {
        q: "æ”¶åˆ°ç¥ç¦åè¦åšä»€ä¹ˆï¼Ÿ",
        options: ["å¼€å¿ƒç¬‘ä¸€ä¸‹", "ç«‹åˆ»åŠ ç­", "å»è·‘åå…¬é‡Œ"],
        answerIndex: 0,
      },
    ];

    // ====== ä¸“å±ç¥ç¦ ======
    const BLESSINGS = [
      "å°æŒ‘æˆ˜é€šå…³ï¼ä¸“å±ç¥ç¦æ¥å•¦ï½",
      "æ„Ÿè°¢ä½ æ¯å¤©è¾›è‹¦èµšé’±å…»å®¶",
      "æ„¿ä½ å°‘ç‚¹çƒ¦æ¼ï¼Œå¤šç‚¹å¼€å¿ƒ",
      "åƒå˜›å˜›é¦™ï¼Œèº«ä½“å€å„¿æ£’",
      "æ°¸è¿œæ˜¯æˆ‘æœ€é è°±çš„è€çˆ¸ï¼â¤ï¸",
      "ä½ æœ€å¯çˆ±çš„å®è´å¥³å„¿åˆ˜æµ©ç„¶ã€‚",
    ];

    // ====== èƒŒæ™¯éŸ³ä¹ï¼ˆWebAudioï¼‰ ======
    let audioCtx, isPlaying = false, playTimer = null, osc = null, gain = null;
    const musicBtn = document.getElementById('musicBtn');
    // Cå¤§è°ƒã€Œç”Ÿæ—¥å¿«ä¹æ­Œã€ç®€æ˜“æ—‹å¾‹ï¼ˆé¢‘ç‡Hzï¼Œæ—¶å€¼msï¼‰
    const MELODY = [
      // ç¥ä½ ç”Ÿæ—¥å¿«ä¹
      [264,400],[264,200],[297,600],[264,600],[352,600],[330,900],
      // ç¥ä½ ç”Ÿæ—¥å¿«ä¹
      [264,400],[264,200],[297,600],[264,600],[396,600],[352,900],
      // ç¥ä½ ç”Ÿæ—¥å¿«ä¹ï¼Œäº²çˆ±çš„Ã—Ã—
      [264,400],[264,200],[528,600],[440,600],[352,600],[330,600],[297,900],
      // ç¥ä½ ç”Ÿæ—¥å¿«ä¹
      [466,400],[466,200],[440,600],[352,600],[396,600],[352,900]
    ];

    function startMusic(){
      if(isPlaying) return;
      if(!audioCtx){
        const AC = window.AudioContext || window.webkitAudioContext;
        audioCtx = new AC();
      }
      isPlaying = true;
      musicBtn.setAttribute('aria-pressed','true');
      musicBtn.textContent = 'ğŸµ æ­£åœ¨æ’­æ”¾';
      let i = 0;
      const playNext = ()=>{
        if(!isPlaying) return;
        const [freq, dur] = MELODY[i];
        // åˆ›å»ºä¸€æ¬¡æ€§éŸ³ç¬¦
        osc = audioCtx.createOscillator();
        gain = audioCtx.createGain();
        osc.type = 'sine';
        osc.frequency.setValueAtTime(freq, audioCtx.currentTime);
        gain.gain.setValueAtTime(0, audioCtx.currentTime);
        gain.gain.linearRampToValueAtTime(0.18, audioCtx.currentTime + 0.02);
        gain.gain.linearRampToValueAtTime(0.15, audioCtx.currentTime + (dur/1000) - 0.04);
        gain.gain.linearRampToValueAtTime(0, audioCtx.currentTime + (dur/1000));
        osc.connect(gain).connect(audioCtx.destination);
        osc.start();
        osc.stop(audioCtx.currentTime + (dur/1000));
        i = (i + 1) % MELODY.length; // å¾ªç¯æ’­æ”¾
        playTimer = setTimeout(playNext, dur);
      };
      playNext();
    }

    function stopMusic(){
      isPlaying = false;
      musicBtn.setAttribute('aria-pressed','false');
      musicBtn.textContent = 'ğŸµ èƒŒæ™¯éŸ³ä¹';
      if(playTimer) { clearTimeout(playTimer); playTimer = null; }
      try{ if(osc) osc.stop(); }catch(e){}
    }

    function toggleMusic(){
      if(!isPlaying) startMusic(); else stopMusic();
    }

    function ensureMusicStarted(){
      // åœ¨é¦–æ¬¡æ­£ç¡®ç­”é¢˜åå°è¯•å¯åŠ¨ï¼ˆè§„é¿è‡ªåŠ¨æ’­æ”¾é™åˆ¶ï¼‰
      if(!isPlaying) startMusic();
    }

    musicBtn?.addEventListener('click', ()=>{
      // ç”¨æˆ·æ‰‹åŠ¿è§¦å‘ï¼Œç¡®ä¿AudioContextå¯ç”¨
      if(audioCtx && audioCtx.state === 'suspended') audioCtx.resume();
      toggleMusic();
    });

    // ====== ç®€æ˜“æµ‹éªŒé€»è¾‘ ======
    const qText = document.getElementById('qText');
    const opts = document.getElementById('opts');
    const hint = document.getElementById('hint');
    const stepTxt = document.getElementById('stepTxt');
    const bar = document.getElementById('bar');
    const quiz = document.getElementById('quiz');
    const done = document.getElementById('done');
    const msgs = document.getElementById('msgs');
    const again = document.getElementById('again');

    let idx = 0;

    function renderQuestion() {
      const total = QUESTIONS.length;
      const cur = QUESTIONS[idx];
      // é˜²å¾¡ï¼šè‹¥å…ƒç´ å¼‚å¸¸ç¼ºå¤±ï¼Œç›´æ¥ä¸­æ­¢æ¸²æŸ“å¹¶ç»™å‡ºæç¤º
      if(!qText || !opts || !stepTxt){
        console.error('å…³é”®èŠ‚ç‚¹ç¼ºå¤±ï¼Œæ— æ³•æ¸²æŸ“é¢˜ç›®');
        return;
      }
      qText.textContent = cur.q;
      stepTxt.textContent = `ç¬¬ ${idx+1}/${total} é¢˜`;
      bar.style.width = `${((idx)/total)*100}%`;
      hint.textContent = '';
      opts.innerHTML = '';
      cur.options.forEach((text, i)=>{
        const b = document.createElement('button');
        b.className = 'btn';
        b.textContent = text;
        b.addEventListener('click', ()=> selectOption(i));
        opts.appendChild(b);
      });
    }

    function selectOption(i){
      const cur = QUESTIONS[idx];
      const buttons = [...document.querySelectorAll('.options .btn')];
      const correct = i === cur.answerIndex;
      buttons.forEach((b,k)=> b.classList.toggle('ok', k===cur.answerIndex));
      if(!correct){
        buttons[i].classList.add('no');
        hint.textContent = 'å·®ä¸€ç‚¹ç‚¹å“¦ï¼Œå†ä»”ç»†æƒ³æƒ³å§ã€‚';
        shakeCard();
        return;
      }
      // æ­£ç¡®ï¼šè½»å¾®åº†ç¥ + æ’­æ”¾éŸ³ä¹ + ä¸‹ä¸€é¢˜æˆ–å®Œæˆ
      sparkleAt(Math.random()*innerWidth, Math.random()*innerHeight*0.5+innerHeight*0.2);
      ensureMusicStarted();
      setTimeout(()=>{
        idx++;
        if(idx < QUESTIONS.length){
          renderQuestion();
        }else{
          finish();
        }
      }, 450);
    }

    function shakeCard(){
      const card = document.getElementById('quizCard');
      card.classList.remove('shake');
      // å¼ºåˆ¶é‡æ’ä»¥é‡æ–°è§¦å‘åŠ¨ç”»
      void card.offsetWidth;
      card.classList.add('shake');
    }

    function finish(){
      // æ»¡è¿›åº¦
      bar.style.width = '100%';
      quiz.style.display = 'none';
      // æ˜¾ç¤ºè›‹ç³•å’Œèœ¡çƒ›
      document.getElementById('cakeStage').classList.add('show');
      const cakeEl = document.getElementById('cake');
      const blowEl = document.getElementById('blowText');

      // 5ç§’åè‡ªåŠ¨"å¹"ç­èœ¡çƒ›
      setTimeout(()=>{
        cakeEl.classList.add('out'); // ç†„ç­
        blowEl.textContent = 'è®¸ä¸ªæ„¿å§';
        // å°çƒŸèŠ±åº†ç¥
        sparkleAt(innerWidth*0.5, innerHeight*0.28, 120);
        // å†è¿‡ 800ms å±•ç¤ºç¥ç¦
        setTimeout(()=>{
          document.getElementById('cakeStage').classList.remove('show');
          done.classList.add('show');
          showBlessings();
          sparkleAt(innerWidth*0.5, innerHeight*0.35, 140);
          sparkleAt(innerWidth*0.75, innerHeight*0.42, 120);
          sparkleAt(innerWidth*0.25, innerHeight*0.42, 120);
        }, 5000);
      }, 5000);
    }

    function showBlessings(){
      msgs.innerHTML = '';
      BLESSINGS.forEach((line, i)=>{
        const p = document.createElement('div');
        p.className = 'msg';
        p.textContent = '';
        msgs.appendChild(p);
        setTimeout(()=>{
          typeText(p, line, 18);
          p.classList.add('show');
        }, i*900);
      });
    }

    again.addEventListener('click', ()=>{
      done.classList.remove('show');
      quiz.style.display = '';
      idx = 0; renderQuestion();
      // è¿æ”¾ä¸‰æ¬¡çƒŸèŠ±
      for(let k=0;k<3;k++) setTimeout(()=> sparkleAt(Math.random()*innerWidth, innerHeight*0.3 + Math.random()*innerHeight*0.4), 250*k);
    });

    function typeText(el, text, speed=20){
      let i = 0;
      const tick = ()=>{
        if(i<=text.length){
          el.textContent = text.slice(0,i);
          i++;
          setTimeout(tick, speed);
        }
      };
      tick();
    }

    // ====== çƒŸèŠ±ç‰¹æ•ˆï¼ˆCanvasï¼‰ ======
    const cvs = document.getElementById('fx');
    const ctx = cvs.getContext('2d');
    let W, H, DPR;

    function resize(){
      DPR = Math.min(2, devicePixelRatio || 1);
      W = cvs.width = innerWidth * DPR;
      H = cvs.height = innerHeight * DPR;
      cvs.style.width = innerWidth + 'px';
      cvs.style.height = innerHeight + 'px';
      ctx.setTransform(DPR,0,0,DPR,0,0);
    }
    addEventListener('resize', resize);
    resize();

    const rockets = [];
    const particles = [];
    const gravity = 0.08;

    function launch(x){
      rockets.push({x, y: H/DPR, vx: (Math.random()-0.5)*1.2, vy: - (5.5 + Math.random()*2.5), color: randColor(), life: 50 + Math.random()*20});
    }

    function explode(x, y, power=100, color){
      const count = power;
      for(let i=0;i<count;i++){
        const a = Math.random()*Math.PI*2;
        const speed = Math.random()*3.2 + 1.2;
        particles.push({
          x, y, vx: Math.cos(a)*speed, vy: Math.sin(a)*speed, alpha:1, decay: 0.008 + Math.random()*0.015, color: color || randColor(), size: 2 + Math.random()*2
        });
      }
    }

    function randColor(){
      const palette = ['#ff6b6b','#ffd166','#06d6a0','#4dabf7','#a78bfa','#f472b6','#facc15'];
      return palette[(Math.random()*palette.length)|0];
    }

    function sparkleAt(px, py, power){
      explode(px, py, power||90);
    }

    let last = performance.now();
    function tick(now){
      const dt = Math.min(33, now - last); // ms
      last = now;
      // èƒŒæ™¯æ¸éš
      ctx.globalCompositeOperation = 'source-over';
      ctx.fillStyle = 'rgba(3,7,18,0.35)';
      ctx.fillRect(0,0,innerWidth,innerHeight);

      // éšæœºå‘å°„ç«ç®­
      if(Math.random() < 0.03) launch(Math.random()*innerWidth);

      // æ›´æ–°ç«ç®­
      ctx.globalCompositeOperation = 'lighter';
      rockets.forEach((r, i)=>{
        r.x += r.vx;
        r.y += r.vy;
        r.vy += gravity * -0.15; // å‘ä¸Šè¡°å‡
        r.life -= 1;
        // ç”»ç«ç®­
        ctx.beginPath();
        ctx.arc(r.x, r.y, 2.2, 0, Math.PI*2);
        ctx.fillStyle = r.color;
        ctx.fill();
        // è½¨è¿¹
        ctx.fillStyle = 'rgba(255,255,255,.35)';
        ctx.fillRect(r.x-0.5, r.y+6, 1, 12);
        if(r.vy >= -0.5 || r.life<=0){
          explode(r.x, r.y, 90 + Math.random()*50, r.color);
          rockets.splice(i,1);
        }
      });

      // æ›´æ–°ç²’å­
      for(let i=particles.length-1;i>=0;i--){
        const p = particles[i];
        p.vy += gravity * 0.12;
        p.x += p.vx;
        p.y += p.vy;
        p.alpha -= p.decay;
        if(p.alpha <= 0){ particles.splice(i,1); continue; }
        ctx.globalAlpha = Math.max(0, p.alpha);
        ctx.beginPath();
        ctx.arc(p.x, p.y, p.size, 0, Math.PI*2);
        ctx.fillStyle = p.color;
        ctx.fill();
      }
      ctx.globalAlpha = 1;

      requestAnimationFrame(tick);
    }
    requestAnimationFrame(tick);

    // äº¤äº’çƒŸèŠ±
    addEventListener('click', e=> {
      sparkleAt(e.clientX, e.clientY, 120);
    });
    addEventListener('touchstart', e=>{
      const t = e.touches[0];
      sparkleAt(t.clientX, t.clientY, 120);
    }, {passive:true});

    // ====== è¿è¡Œæ—¶è‡ªæ£€ï¼ˆç®€å•æµ‹è¯•ç”¨ä¾‹ï¼‰
    (function selfTests(){
      console.assert(Array.isArray(QUESTIONS) && QUESTIONS.length === 3, 'QUESTIONS é•¿åº¦åº”ä¸º 3');
      console.assert(QUESTIONS[0].options.join(',') === 'è€çˆ¸,è€å¦ˆ,å°éƒ­', 'ç¬¬1é¢˜é€‰é¡¹åº”ä¸º è€çˆ¸/è€å¦ˆ/å°éƒ­');
      console.assert(QUESTIONS[1].options.join(',') === 'è€çˆ¸,è€å¦ˆ,å°éƒ­', 'ç¬¬2é¢˜é€‰é¡¹åº”ä¸º è€çˆ¸/è€å¦ˆ/å°éƒ­');
      console.assert(typeof BLESSINGS!== 'undefined' && BLESSINGS.length === 6, 'åº”åŒ…å« 6 æ¡ç¥ç¦ï¼ˆå«ç½²åï¼‰');
      console.assert(document.getElementById('cakeStage') && document.getElementById('cake'), 'åº”å­˜åœ¨è›‹ç³•èˆå°ä¸è›‹ç³•å…ƒç´ ');
      // âœ… æ–°å¢ï¼šå…³é”®èŠ‚ç‚¹å­˜åœ¨æ€§
      ;['qText','opts','hint','stepTxt','bar','quiz','done','msgs','again'].forEach(id=>{
        console.assert(document.getElementById(id), `ç¼ºå°‘å¿…è¦å…ƒç´  #${id}`);
      });
      // âœ… æ–°å¢ï¼šé¦–æ¬¡æ¸²æŸ“åé¢˜ç›®æ–‡æœ¬åº”ä¸ºç¬¬1é¢˜
      setTimeout(()=>{
        const t = document.getElementById('qText')?.textContent || '';
        console.assert(t.includes('ä»Šå¤©è°æœ€å¸…'), 'renderQuestion æœªæ­£ç¡®æ¸²æŸ“ç¬¬ 1 é¢˜');
      }, 50);
      // ä»ä¿ç•™ï¼š5.5s åèœ¡çƒ›åº”ä¸ºç†„ç­çŠ¶æ€
      setTimeout(()=>{
        const out = document.getElementById('cake').classList.contains('out');
        console.assert(out, '5ç§’åèœ¡çƒ›åº”ç†„ç­');
      }, 5500);
    })();

    // åˆå§‹åŒ–
    renderQuestion();
    // é¡µé¢è½½å…¥åè‡ªåŠ¨æ’­æ”¾ï¼ˆè‹¥è¢«æµè§ˆå™¨é˜»æ­¢ï¼Œå°†åœ¨ç”¨æˆ·é¦–æ¬¡äº¤äº’æ—¶æ’­æ”¾ï¼‰
    startMusic();

    // è‹¥è¢«ç­–ç•¥é˜»æ­¢ï¼Œé¦–æ¬¡ç”¨æˆ·äº¤äº’æ—¶æ¢å¤
    const resumeOnUserGesture = ()=>{
      if(audioCtx && audioCtx.state === 'suspended') audioCtx.resume();
      ensureMusicStarted();
      removeEventListener('pointerdown', resumeOnUserGesture);
    };
    addEventListener('pointerdown', resumeOnUserGesture, { once: true });
  </script>
</body>
</html>
